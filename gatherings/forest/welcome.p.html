<style>
    .welcome {
        color: #D0CDBE;
        position: absolute;
        top: 50%;
        left: 19%;
        font-size: 4.7vmin;
        font-family: trebuchet ms, sans-serif;
        transform: perspective(950px) rotate(3deg) rotateY(-20deg) skew(3deg);
        text-align: right;
        opacity: 90%;
    }

    .Dialog {
        overflow: hidden;
        width: 100%;
        height: 100%;
    }

    .Dialog-text {
        margin: 0;
    }

    a {
        color: #76b2d4;
    }
</style>

<body>
    <img class="background" src="./images/landing.gif">

    <div class="welcome"><a class="cursor-shoes" style="color: #2e26c7" href="./1.html">please leave your shoes<br> at
            the door</a>
        <br>— the parks staff
    </div>

    <a id="stop" class="hotspot" href="#" style="left: 25%; top: 23%; width: 8%; height: 5%;" data-turbo="false"></a>

    <a class="hotspot" href="./55highway_to_the_cosmodrome.html"
        style="left: 7.188%; top: 17.996%; width: 17%; height: 9%"></a>

    <a class="hotspot centered cursor-bird"
        href="https://twitter.com/intent/tweet?text=.@flantz i love to click hyperlinks and play a videogame story — the parks staff &"
        target="_blank" rel="noreferrer" style="left: 91.188%; top: 73.996%; width: 4%; height: 5%"></a>

    <a-dumpling id="stop-dialog" temperament="phlegmatic" hidden x=37 y=18 width=16 height=15>
        <div class="Dialog">
            <p class="Dialog-text">please look both ways before entering the park. drivers are pretty careless around
                here.</p>
        </div>
    </a-dumpling>

    <a-dumpling temperament='phlegmatic' id='version' focused x=69 y=5 width=16 height=21>
        <iframe src='../../misc/version.html'></iframe>
    </a-dumpling>

    <a-dumpling temperament='choleric' id='speedrun' persistent hidden x=110 y=00 width=40 height=90>
        <iframe src='./items/speedrun.html'></iframe>
    </a-dumpling>

    <a-dumpling temperament='choleric' persistent x=105 y=65 width=40 height=40>
        <div>
            <script type="module">
                import { kInventory } from "./inventory.js"
                const assistant = document.getElementById('virtual-assistant')
                let clickCount = 0
                const phrases = [
                    "Hello friend, feel free to ask for help whenever you feel lost",
                    "I am here to give you peace and tranquility",
                    "Click around, look for changed in your cursor, find friends, and most importantly, live the experience, theres's nothing to understand, really"
                ]
                function onNoPhrase(i) {
                    return `You clicked me ${i} times before`
                }
                function OnClickAssitant(e) {
                    const invRect = document.getElementById('inventory').getBoundingClientRect()
                    const selfRect = assistant.getBoundingClientRect()
                    const xOffset = -20
                    const yOffset = -20 + (clickCount % 10) * 20
                    const x = (xOffset + selfRect.right - invRect.left) / invRect.width * 100
                    const y = (yOffset + selfRect.top - invRect.top) / invRect.height * 100
                    kInventory.add({
                        id: 'assistant' + clickCount,
                        html: `
                            <a-dumpling persistent temperament="phlegmatic" x=${x} y=${y} width=20 height=20>
                                <div>
                                    ${clickCount < phrases.length ? phrases[clickCount] : onNoPhrase(clickCount)}
                                </div>
                            </a-dumpling>
                        `
                    })
                    clickCount++
                }
                assistant.onclick = OnClickAssitant;
            </script>
            <style>
                .virtual-assistant {
                    cursor: help;
                }
                .virtual-assistant img {
                    width: 100%;
                    height: 100%;
                }
            </style>
            <div class='virtual-assistant'>
                <img id='virtual-assistant' src="../../d/img/irene.gif">
            </div>
        </div>
    </a-dumpling>
</body>

<script>
    // TODO: I absolutely hate this, but I am tired and I cant figure out another way to make this thing show when coming from another window
    setTimeout(() => {
        const hash = window.location.hash.slice(1)
        if (hash === 'gamermode') {
            Frames.toggle('speedrun')
        }
    }, 1000)

    document.getElementById("stop").addEventListener("click", (evt) => {
        evt.preventDefault()

        // harsh era
        const title = document.querySelector("title")
        title.innerHTML = "don't go!"

        // mellow era
        Frames.toggle("stop-dialog")
    })
</script>
