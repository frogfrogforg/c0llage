<head>
    <script src="common.js"></script>
    <link rel="stylesheet" href="../shared/frames.css">
    <style>
        body {
            position: relative;
            background-color: blue;
            overflow: hidden;
        }

        .icons {
            position: fixed;
        }

        .icon {
            image-rendering: pixelated;
            position: absolute;
            cursor: pointer;
            width: 128px;
            height: 128px;
        }

        iframe {
            border: 0;
            --scaleFactor: 0.6;
            /*scale iframe content by this factor (probably breaks on older browsers)*/
            width: calc(100%/var(--scaleFactor)) !important;
            height: calc(100%/var(--scaleFactor)) !important;
            transform: scale(var(--scaleFactor));
            transform-origin: top left
        }
    </style>
</head>

<body>
    <section id="frames" class="Frames">
        <draggable-frame id="alidator-frame" hidden>
            <iframe style="--scaleFactor: 1.0;" id="alidator" src="../../Jen/alidator.html"></iframe>
        </draggable-frame>

        <draggable-frame id="forest-frame" hidden>
            <iframe style="--scaleFactor: 0.5;" id="forest" src="./1.html"></iframe>
        </draggable-frame>

        <draggable-frame id="main-frame" hidden>
            <iframe style="--scaleFactor: 1.0;" id="main" src="../../index.html"></iframe>
        </draggable-frame>

    </section>

    <div id=" icons" class="icons" style="left:50px; top:50px;">
        <pc-icon target="alidator-frame" src="./images/alidator-icon.png"></pc-icon>

        <pc-icon target="forest-frame" src="./images/forest-icon.png"></pc-icon>

        <pc-icon target="main-frame" src="./images/main-icon.png"></pc-icon>

	<a href="./computer.html">
	  <img class="icon" 
	       style="left: 666px; top: 420px;"
	       src="/images/aligator.png">
	  </img>
	</a>
    </div>

    <script type="module">
        import "../../core/events.js"
        import * as Frames from "../shared/frames.js"

        const tagName = 'pc-icon'
        const iconTemplate = `
<img class="icon" id="$id"
                src="$src">
            </img>
        `
        function initializeIcons(padding) {
            document.createElement(tagName)
            const tagInstances = document.getElementsByTagName(tagName)
            let posx = 0;
            while (tagInstances.length > 0) {
                let element = tagInstances[0]
                const target = element.attributes.target.value
                const src = element.attributes.src.value
                const id = `${target}-icon`
                element.outerHTML = iconTemplate
                    .replaceAll('$id', id)
                    .replaceAll('$src', src)

                const targetFrame = document.getElementById(target);
                const icon = document.getElementById(id);
                icon.onclick = () => {
                    // very hacky sorry
		    // <3
                    if (targetFrame.classList.contains("Frame-Hidden") == true) {
                        icon.style.filter = "invert(1)"
                        targetFrame.classList.remove("Frame-Hidden")
                    } else {
                        icon.style.filter = "none"
                        targetFrame.classList.add("Frame-Hidden")
                    }
                }
                icon.style.left = posx
                posx += padding
            }
        }

        function main() {
            Frames.init()
            initializeIcons(200)
        }

        main()


    </script>
</body>
